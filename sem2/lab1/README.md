# Система подготовки к экзамену

Небольшая консольная система для ведения учебного процесса: создание студента, управление книгами и билетами, запуск учебных активностей (чтение, практика, тестирование, повторение), хранение истории действий и сохранение состояния.

**Язык:** Python 3

## Общее описание

Система хранит данные в памяти во время работы и сохраняет/загружает их из JSON-файла. Основной управляющий класс — `StudySystem`, который объединяет данные студента, коллекции книг и билетов, а также историю действий. Учебные активности реализованы через иерархию методов (`Method`) с конкретными реализациями (`Read`, `Practice`, `Testing`, `Review`).

## Структура проекта

- `src/main.py` — консольный интерфейс, меню, ввод данных и вызовы методов системы.
- `src/services/study_system.py` — ядро системы: бизнес-логика, управление сущностями и историей.
- `src/services/storage.py` — сохранение/загрузка состояния в `data/state.json`.
- `src/models/` — модели предметной области:
  - `student.py` — студент.
  - `book.py`, `material.py` — книги и базовый учебный материал.
  - `ticket.py` — экзаменационный билет.
  - `time.py` — работа со временем и длительностью.
  - `method.py`, `read.py`, `practice.py`, `testing.py`, `review.py` — учебные активности.
- `tests/` — модульные тесты ключевой логики.

## Основные сущности

### `StudySystem`
Хранит:
- `student: Optional[Student]`
- `books: List[Book]`
- `tickets: List[Ticket]`
- `history: List[str]`

Ключевые операции:
- Создание/сброс студента: `create_student()`.
- Управление книгами: `add_book()`, `list_books()`, `find_book()`.
- Управление билетами: `add_ticket()`, `add_ticket_question()`, `list_tickets()`, `mark_ticket_learned()`.
- Запуск активностей: `run_read()`, `run_practice()`, `run_testing()`, `run_ticket_review()`.
- Отчёты: `status()`, `last_actions()`, `show_ticket_questions()`.
- Сериализация: `to_dict()`, `from_dict()`.

### `Student`
- Поля: `name`, `surname`, `group`, `tickets`.
- Методы: `get_full_name()`, `add_ticket()`, `__str__()`.

### `Book` и `StudyMaterial`
- `StudyMaterial` — абстракция учебного материала с обязательным `get_info()`.
- `Book` добавляет `author`, `pages`, `current_page`, умеет читать страницы через `read_page()`.

### `Ticket`
- Поля: `number`, `questions`, `is_learned`.
- Методы: `add_question()`, `mark_as_learned()`.

### `Time`
- Представление времени в часах и минутах.
- Конвертация: `to_minutes()`, `from_minutes()`.
- Арифметика: `add()`.

### Учебные методы (`Method` и потомки)
Базовый класс `Method` задаёт:
- имя активности,
- длительность (`Time`),
- планирование (`schedule()`),
- флаг завершения.

Конкретные реализации:
- `Read` — читает страницы книги по скорости 2 страницы/минуту.
- `Practice` — решает задачи по скорости 0.5 задачи/минуту.
- `Testing` — решает тестовые вопросы по скорости 2 вопроса/минуту.
- `Review` — повторяет темы по скорости 0.3 темы/минуту.

## Потоки работы (подробно)

1. **Запуск приложения**
   В `src/main.py` создаётся экземпляр `StudySystem` через `load()`.
   Если `data/state.json` отсутствует или повреждён, создаётся пустая система.

2. **Работа со студентом**
   Пользователь создаёт студента через пункт меню.
   При создании нового студента система сбрасывает книги, билеты и историю, чтобы начать новый учебный профиль.

3. **Управление книгами**
   Пользователь добавляет книги (название, предмет, автор, число страниц).
   Список книг формируется с указанием прогресса `current_page`.

4. **Управление билетами**
   Пользователь добавляет билеты по номеру.
   Для каждого билета можно добавлять вопросы.
   Билет можно пометить как выученный, что фиксируется в истории.

5. **Запуск учебных активностей**
   Чтение: выбирается книга, вводится длительность и время начала, система рассчитывает интервал и прогресс чтения.
   Практика: вводится число задач, длительность и время начала, рассчитывается количество решённых задач.
   Тестирование: вводится число вопросов, длительность и время начала, рассчитывается число выполненных вопросов.
   Повторение билета: по номеру билета берутся вопросы и рассчитывается количество повторённых тем.

6. **История и статус**
   Каждая операция добавляет запись в историю.
   Доступен вывод статуса (студент, число книг, число билетов) и последних действий.
   Можно вывести список вопросов выбранного билета.

7. **Завершение работы**
   При выборе выхода состояние сохраняется через `save()` в `data/state.json`.

## Хранение состояния

Состояние сериализуется в JSON-файл:
- Путь: `data/state.json`.
- Формат: словарь с `student`, `books`, `tickets`, `history`.
- Загрузка устойчива к отсутствию/повреждению файла (создаётся новая система).

## Запуск

- Запуск приложения:
  ```bash
  python src/main.py
  ```
- Тесты:
  ```bash
  pytest
  ```

## Тестовое покрытие

Файлы и сценарии тестов:

**`tests/test_study_system.py`**
- создание студента и сброс прошлых данных (`create_student()` очищает книги, билеты и историю);
- добавление билета в систему;
- добавление вопроса в билет;
- вывод списка вопросов билета;
- отметка билета как выученного;
- проверка ошибки при повторении билета без вопросов;
- запуск повторения билета и запись в историю;
- поведение `list_books()` при отсутствии книг;
- добавление книги и корректность списка;
- ошибка при поиске несуществующей книги;
- пустая история и вывод последних действий;
- ошибка при поиске несуществующего билета;
- статус без студента и статус с созданным студентом;
- ошибка при запуске чтения по отсутствующей книге.

**`tests/test_storage.py`**
- сохранение состояния и корректная запись JSON;
- загрузка новой системы при отсутствии файла;
- загрузка новой системы при повреждённом JSON (и вывод сообщения об ошибке).

**`tests/test_book.py`**
- корректность строки `get_info()`;
- увеличение `current_page` при чтении;
- остановка чтения на последней странице;
- защита от превышения количества страниц.

**`tests/test_testing.py`**
- корректный результат и прогресс в тестировании;
- ошибка при нулевом или отрицательном числе вопросов.

**`tests/test_reading.py`**
- ошибка при запуске чтения без книги;
- рост числа прочитанных страниц в допустимых пределах.

**`tests/test_practice.py`**
- рост количества решённых задач;
- возможность завершить все задачи за одну сессию.

**`tests/test_ticket.py`**
- корректная инициализация билета;
- отметка билета как выученного;
- создание билета с заранее заданными вопросами.

**`tests/test_time.py`**
- перевод времени в минуты;
- ошибка при отрицательном времени.

Примечание: отдельного `test_review.py` нет; повторение билета проверяется в `tests/test_study_system.py` через `run_ticket_review()`.

## Ограничения и допущения

- Система рассчитана на одного активного студента.
- Нет многопользовательского режима и конкуррентной записи.
- Все данные хранятся локально в JSON.
